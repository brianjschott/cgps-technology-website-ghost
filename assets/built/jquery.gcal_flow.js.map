{"version":3,"file":"jquery.gcal_flow.js","sources":["jquery.gcal_flow.js"],"sourcesContent":["// Generated by CoffeeScript 1.9.3\n(function() {\n  var $, gCalFlow, j, len, log, methods, pad_zero, prio, ref;\n\n  $ = jQuery;\n\n  log = {};\n\n  log.error = log.warn = log.log = log.info = log.debug = function() {};\n\n  if ((typeof window !== \"undefined\" && window !== null) && (typeof console !== \"undefined\" && console !== null) && (console.log != null)) {\n    if (!window._gCalFlow_quiet) {\n      ref = ['error', 'warn', 'info'];\n      for (j = 0, len = ref.length; j < len; j++) {\n        prio = ref[j];\n        log[prio] = function() {\n          if (console[prio]) {\n            return console[prio].apply(console, arguments);\n          } else {\n            return console.log.apply(console, arguments);\n          }\n        };\n      }\n    }\n    if (window._gCalFlow_debug) {\n      log.debug = function() {\n        if (console.debug != null) {\n          return console.debug.apply(console, arguments);\n        } else {\n          return console.log.apply(console, arguments);\n        }\n      };\n    }\n  }\n\n  pad_zero = function(num, size) {\n    var i, k, ref1, ret;\n    if (size == null) {\n      size = 2;\n    }\n    if (10 * (size - 1) <= num) {\n      return num;\n    }\n    ret = \"\";\n    for (i = k = 1, ref1 = size - (\"\" + num).length; 1 <= ref1 ? k <= ref1 : k >= ref1; i = 1 <= ref1 ? ++k : --k) {\n      ret = ret.concat(\"0\");\n    }\n    return ret.concat(num);\n  };\n\n  gCalFlow = (function() {\n    gCalFlow.demo_apikey = 'AIzaSyD0vtTUjLXzH4oKCzNRDymL6E3jKBympf0';\n\n    gCalFlow.prototype.target = null;\n\n    gCalFlow.prototype.template = $(\"<div class=\\\"gCalFlow\\\">\\n  <div class=\\\"gcf-header-block\\\">\\n    <div class=\\\"gcf-title-block\\\">\\n      <span class=\\\"gcf-title\\\"></span>\\n    </div>\\n  </div>\\n  <div class=\\\"gcf-item-container-block\\\">\\n    <div class=\\\"gcf-item-block\\\">\\n      <div class=\\\"gcf-item-header-block\\\">\\n        <div class=\\\"gcf-item-date-block\\\">\\n          [<span class=\\\"gcf-item-daterange\\\"></span>]\\n        </div>\\n        <div class=\\\"gcf-item-title-block\\\">\\n          <strong class=\\\"gcf-item-title\\\"></strong>\\n        </div>\\n      </div>\\n      <div class=\\\"gcf-item-body-block\\\">\\n        <div class=\\\"gcf-item-description\\\">\\n        </div>\\n        <div class=\\\"gcf-item-location\\\">\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n  <div class=\\\"gcf-last-update-block\\\">\\n    LastUpdate: <span class=\\\"gcf-last-update\\\"></span>\\n  </div>\\n</div>\");\n\n    gCalFlow.prototype.opts = {\n      maxitem: 15,\n      calid: null,\n      apikey: gCalFlow.demo_apikey,\n      mode: 'upcoming',\n      data_url: null,\n      auto_scroll: true,\n      scroll_interval: 10 * 1000,\n      link_title: true,\n      link_item_title: true,\n      link_item_description: false,\n      link_item_location: false,\n      link_target: '_blank',\n      item_description_as_html: false,\n      callback: null,\n      no_items_html: '',\n      globalize_culture: (typeof navigator !== \"undefined\" && navigator !== null) && (navigator.browserLanguage || navigator.language || navigator.userLanguage),\n      globalize_fmt_datetime: 'f',\n      globalize_fmt_date: 'D',\n      globalize_fmt_time: 't',\n      globalize_fmt_monthday: 'M',\n      date_formatter: function(d, allday_p) {\n        var fmtstr;\n        if ((typeof Globalize !== \"undefined\" && Globalize !== null) && (Globalize.format != null)) {\n          if (allday_p) {\n            fmtstr = this.globalize_fmt_date;\n          } else {\n            fmtstr = this.globalize_fmt_datetime;\n          }\n          return Globalize.format(d, fmtstr);\n        } else {\n          if (allday_p) {\n            return (d.getFullYear()) + \"-\" + (pad_zero(d.getMonth() + 1)) + \"-\" + (pad_zero(d.getDate()));\n          } else {\n            return (d.getFullYear()) + \"-\" + (pad_zero(d.getMonth() + 1)) + \"-\" + (pad_zero(d.getDate())) + \" \" + (pad_zero(d.getHours())) + \":\" + (pad_zero(d.getMinutes()));\n          }\n        }\n      },\n      daterange_formatter: function(sd, ed, allday_p) {\n        var endstr, ret;\n        ret = this.date_formatter(sd, allday_p);\n        if (allday_p) {\n          ed = new Date(ed.getTime() - 86400 * 1000);\n        }\n        endstr = '';\n        if (sd.getDate() !== ed.getDate() || sd.getMonth() !== ed.getMonth()) {\n          if ((typeof Globalize !== \"undefined\" && Globalize !== null) && (Globalize.format != null)) {\n            endstr += Globalize.format(ed, this.globalize_fmt_monthday);\n          } else {\n            endstr += (pad_zero(ed.getMonth() + 1)) + \"-\" + (pad_zero(ed.getDate()));\n          }\n        }\n        if (!allday_p && (sd.getHours() !== ed.getHours() || sd.getMinutes() !== ed.getMinutes())) {\n          if ((typeof Globalize !== \"undefined\" && Globalize !== null) && (Globalize.format != null)) {\n            endstr += Globalize.format(ed, this.globalize_fmt_time);\n          } else {\n            endstr += \" \" + (pad_zero(ed.getHours())) + \":\" + (pad_zero(ed.getMinutes()));\n          }\n        }\n        if (endstr) {\n          ret += \" - \" + endstr;\n        }\n        return ret;\n      }\n    };\n\n    function gCalFlow(target, opts) {\n      this.target = target;\n      target.addClass('gCalFlow');\n      if (target.children().size() > 0) {\n        log.debug(\"Target node has children, use target element as template.\");\n        this.template = target;\n      }\n      this.update_opts(opts);\n    }\n\n    gCalFlow.prototype.update_opts = function(new_opts) {\n      log.debug(\"update_opts was called\");\n      log.debug(\"old options:\", this.opts);\n      this.opts = $.extend({}, this.opts, new_opts);\n      return log.debug(\"new options:\", this.opts);\n    };\n\n    gCalFlow.prototype.gcal_url = function() {\n      var now;\n      if (!this.opts.calid && !this.opts.data_url) {\n        log.error(\"Option calid and data_url are missing. Abort URL generation\");\n        this.target.text(\"Error: You need to set 'calid' or 'data_url' option.\");\n        throw \"gCalFlow: calid and data_url missing\";\n      }\n      if (this.opts.data_url) {\n        return this.opts.data_url;\n      } else if (this.opts.mode === 'updates') {\n        now = new Date().toJSON();\n        return \"https://www.googleapis.com/calendar/v3/calendars/\" + this.opts.calid + \"/events?key=\" + this.opts.apikey + \"&maxResults=\" + this.opts.maxitem + \"&orderBy=updated&timeMin=\" + now + \"&singleEvents=true\";\n      } else {\n        now = new Date().toJSON();\n        return \"https://www.googleapis.com/calendar/v3/calendars/\" + this.opts.calid + \"/events?key=\" + this.opts.apikey + \"&maxResults=\" + this.opts.maxitem + \"&orderBy=startTime&timeMin=\" + now + \"&singleEvents=true\";\n      }\n    };\n\n    gCalFlow.prototype.fetch = function() {\n      var success_handler;\n      log.debug(\"Starting ajax call for \" + (this.gcal_url()));\n      if (this.opts.apikey === this.constructor.demo_apikey) {\n        log.warn(\"You are using built-in demo API key! This key is provided for tiny use or demo only. Your access may be limited.\");\n        log.warn(\"Please check document and consider to use your own key.\");\n      }\n      success_handler = (function(_this) {\n        return function(data) {\n          log.debug(\"Ajax call success. Response data:\", data);\n          return _this.render_data(data, _this);\n        };\n      })(this);\n      return $.ajax({\n        type: 'GET',\n        success: success_handler,\n        dataType: \"jsonp\",\n        url: this.gcal_url()\n      });\n    };\n\n    gCalFlow.prototype.parse_date = function(dstr) {\n      var day, hour, m, min, mon, offset, ret, sec, year;\n      if (m = dstr.match(/^(\\d{4})-(\\d{2})-(\\d{2})$/)) {\n        return new Date(parseInt(m[1], 10), parseInt(m[2], 10) - 1, parseInt(m[3], 10), 0, 0, 0);\n      }\n      offset = (new Date()).getTimezoneOffset() * 60 * 1000;\n      year = mon = day = null;\n      hour = min = sec = 0;\n      if (m = dstr.match(/^(\\d{4})-(\\d{2})-(\\d{2})[T ](\\d{2}):(\\d{2}):(\\d{2}(?:\\.\\d+)?)(Z|([+-])(\\d{2}):(\\d{2}))$/)) {\n        year = parseInt(m[1], 10);\n        mon = parseInt(m[2], 10);\n        day = parseInt(m[3], 10);\n        hour = parseInt(m[4], 10);\n        min = parseInt(m[5], 10);\n        sec = parseInt(m[6], 10);\n        offset = (new Date(year, mon - 1, day, hour, min, sec)).getTimezoneOffset() * 60 * 1000;\n        if (m[7] !== \"Z\") {\n          offset += (m[8] === \"+\" ? 1 : -1) * (parseInt(m[9], 10) * 60 + parseInt(m[10], 10)) * 1000 * 60;\n        }\n      } else {\n        log.warn(\"Time parse error! Unknown time pattern: \" + dstr);\n        return new Date(1970, 1, 1, 0, 0, 0);\n      }\n      log.debug(\"time parse (gap to local): \" + offset);\n      ret = new Date(new Date(year, mon - 1, day, hour, min, sec).getTime() - offset);\n      log.debug(\"time parse: \" + dstr + \" -> \", ret);\n      return ret;\n    };\n\n    gCalFlow.prototype.render_data = function(data) {\n      var ci, desc_body_method, ed, ent, et, etf, gmapslink, ic, it, items, k, len1, link, ref1, ref2, sd, st, stf, t, titlelink;\n      log.debug(\"start rendering for data:\", data);\n      t = this.template.clone();\n      titlelink = (ref1 = this.opts.titlelink) != null ? ref1 : \"http://www.google.com/calendar/embed?src=\" + this.opts.calid;\n      if (this.opts.link_title) {\n        t.find('.gcf-title').html($(\"<a />\").attr({\n          target: this.opts.link_target,\n          href: titlelink\n        }).text(data.summary));\n      } else {\n        t.find('.gcf-title').text(data.summary);\n      }\n      t.find('.gcf-link').attr({\n        target: this.opts.link_target,\n        href: titlelink\n      });\n      t.find('.gcf-last-update').html(this.opts.date_formatter(this.parse_date(data.updated)));\n      it = t.find('.gcf-item-block');\n      it.detach();\n      it = $(it[0]);\n      log.debug(\"item block template:\", it);\n      items = $();\n      log.debug(\"render entries:\", data.items);\n      if (this.opts.item_description_as_html) {\n        desc_body_method = 'html';\n      } else {\n        desc_body_method = 'text';\n      }\n      if ((data.items != null) && data.items.length > 0) {\n        ref2 = data.items.slice(0, +this.opts.maxitem + 1 || 9e9);\n        for (k = 0, len1 = ref2.length; k < len1; k++) {\n          ent = ref2[k];\n          log.debug(\"formatting entry:\", ent);\n          ci = it.clone();\n          if (ent.start) {\n            if (ent.start.dateTime) {\n              st = ent.start.dateTime;\n            } else {\n              st = ent.start.date;\n            }\n            sd = this.parse_date(st);\n            stf = this.opts.date_formatter(sd, st.indexOf(':') < 0);\n            ci.find('.gcf-item-date').html(stf);\n            ci.find('.gcf-item-start-date').html(stf);\n          }\n          if (ent.end) {\n            if (ent.end.dateTime) {\n              et = ent.end.dateTime;\n            } else {\n              et = ent.end.date;\n            }\n            ed = this.parse_date(et);\n            etf = this.opts.date_formatter(ed, et.indexOf(':') < 0);\n            ci.find('.gcf-item-end-date').html(etf);\n            ci.find('.gcf-item-daterange').html(this.opts.daterange_formatter(sd, ed, st.indexOf(':') < 0));\n          }\n          ci.find('.gcf-item-update-date').html(this.opts.date_formatter(this.parse_date(ent.updated), false));\n          link = $('<a />').attr({\n            target: this.opts.link_target,\n            href: ent.htmlLink\n          });\n          if (this.opts.link_item_title) {\n            ci.find('.gcf-item-title').html(link.clone().text(ent.summary));\n          } else {\n            ci.find('.gcf-item-title').text(ent.summary);\n          }\n          if (this.opts.link_item_description) {\n            ci.find('.gcf-item-description').html(link.clone()[desc_body_method](ent.description));\n          } else {\n            ci.find('.gcf-item-description')[desc_body_method](ent.description);\n          }\n          if (this.opts.link_item_location && ent.location) {\n            gmapslink = \"<a href='https://maps.google.de/maps?q=\" + encodeURI(ent.location.toString().replace(\" \", \"+\")) + \"' target='new'>\" + ent.location + \"</a>\";\n            ci.find('.gcf-item-location').html(gmapslink);\n          } else {\n            ci.find('.gcf-item-location').text(ent.location);\n          }\n          ci.find('.gcf-item-link').attr({\n            href: ent.htmlLink\n          });\n          log.debug(\"formatted item entry:\", ci[0]);\n          items.push(ci[0]);\n        }\n      } else {\n        items = $('<div class=\"gcf-no-items\"></div>').html(this.opts.no_items_html);\n      }\n      log.debug(\"formatted item entry array:\", items);\n      ic = t.find('.gcf-item-container-block');\n      log.debug(\"item container element:\", ic);\n      ic.html(items);\n      this.target.html(t.html());\n      this.bind_scroll();\n      if (this.opts.callback) {\n        return this.opts.callback.apply(this.target);\n      }\n    };\n\n    gCalFlow.prototype.bind_scroll = function() {\n      var scroll_children, scroll_container, scroll_timer, scroller, state;\n      scroll_container = this.target.find('.gcf-item-container-block');\n      scroll_children = scroll_container.find(\".gcf-item-block\");\n      log.debug(\"scroll container:\", scroll_container);\n      if (!this.opts.auto_scroll || scroll_container.size() < 1 || scroll_children.size() < 2) {\n        return;\n      }\n      state = {\n        idx: 0\n      };\n      scroller = function() {\n        var scroll_to;\n        log.debug(\"current scroll position:\", scroll_container.scrollTop());\n        log.debug(\"scroll capacity:\", scroll_container[0].scrollHeight - scroll_container[0].clientHeight);\n        if (typeof scroll_children[state.idx] === 'undefined' || scroll_container.scrollTop() >= scroll_container[0].scrollHeight - scroll_container[0].clientHeight) {\n          log.debug(\"scroll to top\");\n          state.idx = 0;\n          return scroll_container.animate({\n            scrollTop: scroll_children[0].offsetTop\n          });\n        } else {\n          scroll_to = scroll_children[state.idx].offsetTop;\n          log.debug(\"scroll to \" + scroll_to + \"px\");\n          scroll_container.animate({\n            scrollTop: scroll_to\n          });\n          return state.idx += 1;\n        }\n      };\n      return scroll_timer = setInterval(scroller, this.opts.scroll_interval);\n    };\n\n    return gCalFlow;\n\n  })();\n\n  methods = {\n    init: function(opts) {\n      var data;\n      if (opts == null) {\n        opts = {};\n      }\n      data = this.data('gCalFlow');\n      if (!data) {\n        return this.data('gCalFlow', {\n          target: this,\n          obj: new gCalFlow(this, opts)\n        });\n      }\n    },\n    destroy: function() {\n      var data;\n      data = this.data('gCalFlow');\n      data.obj.target = null;\n      $(window).unbind('.gCalFlow');\n      data.gCalFlow.remove();\n      return this.removeData('gCalFlow');\n    },\n    render: function() {\n      if ((typeof Globalize !== \"undefined\" && Globalize !== null) && (Globalize.culture != null)) {\n        Globalize.culture(this.data('gCalFlow').obj.opts.globalize_culture);\n      }\n      return this.data('gCalFlow').obj.fetch();\n    }\n  };\n\n  $.fn.gCalFlow = function(method) {\n    var orig_args;\n    orig_args = arguments;\n    if (typeof method === 'object' || !method) {\n      return this.each(function() {\n        methods.init.apply($(this), orig_args);\n        return methods.render.apply($(this), orig_args);\n      });\n    } else if (methods[method]) {\n      return this.each(function() {\n        return methods[method].apply($(this), Array.prototype.slice.call(orig_args, 1));\n      });\n    } else if (method === 'version') {\n      return \"3.0.2\";\n    } else {\n      return $.error(\"Method \" + method + \" does not exist on jQuery.gCalFlow\");\n    }\n  };\n\n}).call(this);\n"],"names":["gCalFlow","j","len","methods","pad_zero","prio","ref","$","jQuery","log","error","warn","info","debug","window","console","_gCalFlow_quiet","length","apply","arguments","_gCalFlow_debug","target","opts","this","addClass","children","size","template","update_opts","num","k","ref1","ret","concat","demo_apikey","prototype","maxitem","calid","apikey","mode","data_url","auto_scroll","scroll_interval","link_title","link_item_title","link_item_description","link_item_location","link_target","item_description_as_html","callback","no_items_html","globalize_culture","navigator","browserLanguage","language","userLanguage","globalize_fmt_datetime","globalize_fmt_date","globalize_fmt_time","globalize_fmt_monthday","date_formatter","d","allday_p","fmtstr","Globalize","format","getFullYear","getMonth","getDate","getHours","getMinutes","daterange_formatter","sd","ed","endstr","Date","getTime","new_opts","extend","gcal_url","now","text","toJSON","fetch","success_handler","_this","constructor","data","render_data","ajax","type","success","dataType","url","parse_date","dstr","day","hour","m","min","mon","offset","sec","year","match","parseInt","getTimezoneOffset","ci","desc_body_method","ent","et","etf","gmapslink","ic","it","items","len1","link","ref2","st","stf","t","titlelink","clone","find","html","attr","href","summary","updated","detach","slice","start","dateTime","date","indexOf","end","htmlLink","description","location","encodeURI","toString","replace","push","bind_scroll","state","scroll_container","scroll_children","idx","setInterval","scroll_to","scrollTop","scrollHeight","clientHeight","animate","offsetTop","init","obj","destroy","unbind","remove","removeData","render","culture","fn","method","orig_args","each","Array","call"],"mappings":"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"}